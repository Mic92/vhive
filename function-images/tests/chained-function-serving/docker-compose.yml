version: "3.7"

services:
    consumer:
        build:
            context: .
            target: consumer
        volumes:
            - log-volume:/app/log

    producer:
        build:
            context: .
            target: producer
        ports: 
            - "3031:3031"
        volumes:
            - log-volume:/app/log
        command: go run ./producer/producer.go --addr consumer
        depends_on:
            - consumer

volumes:
    log-volume: